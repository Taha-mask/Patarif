<app-game-template 
  [showHeader]="false" 
  [showTopIcons]="false" 
  [noCardBackground]="true"
  [nogamecontent]="true"
  >  

  <div class="container">
    <!-- Top Logo -->
   <div class="header d-flex justify-content-between px-3 py-2">
    <div class="Logo">
      <img src="/images/logo-patarif.png" alt="p" style="width: 100px; height: 100px;">
    </div>
   <div class="back d-flex gap-3"> 
    
    <button class="tool-btn" 
    (click)="undo()" 
    [disabled]="historyIndex <= 0"
    title="Undo">
<i class="fas fa-undo"></i>
</button>
<button class="tool-btn" 
    (click)="redo()" 
    [disabled]="historyIndex >= drawingHistory.length - 1"
    title="Redo">
<i class="fas fa-redo"></i>
</button>
</div>

</div>
  
    <!-- Main Canvas Area -->
    <div class="main-container">
      
      <!-- Canvas Area -->
      <div class="canvas-area">
        <div class="canvas-wrapper">
          <canvas #drawingCanvas
                  class="drawing-canvas"
                  (mousedown)="startDrawing($event)"
                  (mousemove)="onMouseMove($event)"
                  (mouseup)="stopDrawing()"
                  (mouseenter)="onMouseEnter()"
                  (mouseleave)="onMouseLeave()"
                  (touchstart)="startDrawing($event)"
                  (touchmove)="onTouchMove($event)"
                  (touchend)="stopDrawing()"
                  (contextmenu)="$event.preventDefault()">
          </canvas>
          <div #cursorElement class="cursor" [class.pen]="currentTool !== 'eraser'" [class.eraser]="currentTool === 'eraser'"></div>
        </div>
      </div>

      <!-- Right Tool Panel -->
      <div class="right-toolbar">
        
        <button class="tool-btn" 
                (click)="downloadImage()"
                title="Download PNG">
          <i class="fas fa-download"></i>
        </button>
        <button class="tool-btn" 
                (click)="downloadPDF()"
                title="Download PDF">
          <i class="fas fa-file-pdf"></i>
        </button>
        <button class="tool-btn" 
                [class.active]="currentTool === 'eraser'"
                (click)="selectTool('eraser')"
                title="Eraser">
          <i class="fas fa-eraser"></i>
        </button>
        <button class="tool-btn" 
                [class.active]="currentTool === 'pen'"
                (click)="selectTool('pen')"
                title="Pencil">
          <i class="fas fa-pencil-alt"></i>
        </button>
        <button class="tool-btn" 
                [class.active]="currentTool === 'brush'"
                (click)="selectTool('brush')"
                title="Brush">
          <i class="fas fa-paint-brush"></i>
        </button>
      
        <button class="tool-btn" 
                (click)="openColorPicker()"
                title="Color Picker">
          <i class="fas fa-eye-dropper"></i>
        </button>

        <!-- Zoom Controls -->
        <button class="tool-btn" 
                (click)="zoomIn()"
                [disabled]="zoomLevel >= MAX_ZOOM"
                title="Zoom In (Ctrl + +)">
          <i class="fas fa-search-plus"></i>
        </button>
        <button class="tool-btn" 
                (click)="zoomOut()"
                [disabled]="zoomLevel <= MIN_ZOOM"
                title="Zoom Out (Ctrl + -)">
          <i class="fas fa-search-minus"></i>
        </button>
        <button class="tool-btn" 
                (click)="resetZoom()"
                [disabled]="zoomLevel === 1"
                title="Reset Zoom (Ctrl + 0)">
          <i class="fas fa-expand-arrows-alt"></i>
        </button>
        
        <!-- Zoom Level Display -->
        <div class="zoom-display">
          {{ getZoomPercentage() }}%
        </div>

        <!-- Line Size Control -->
        <div class="line-size-wrapper">
          <div class="line-size-control">
            <div class="size-label" (click)="$event.stopPropagation()">
              <i class="fas fa-circle" [style.color]="selectedColor" [style.fontSize.px]="brushSize/2 + 12"></i>
              <!-- <span>{{ brushSize }}px</span> -->
            </div>
          </div>
          
          <!-- Size Presets Column -->
          <div class="size-presets">
            <div 
              *ngFor="let size of [8, 16, 32]"
              class="size-option"
              [class.active]="brushSize === size"
              (click)="setBrushSize(size); $event.stopPropagation()"
              [title]="size + 'px'"
              (mouseenter)="hoveredSize = size"
              (mouseleave)="hoveredSize = null">
              <i 
                class="fas fa-circle" 
                [style.fontSize.px]="size/2 + 4" 
                [style.color]="selectedColor"
                [style.opacity]="hoveredSize === size ? '1' : '0.8'">
              </i>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Bottom Color Palette -->
    <div class="bottom-palette">
      <div class="color-swatches">
        <div *ngFor="let color of basicColors" 
             class="color-swatch"
             [style.background]="color"
             [class.active]="selectedColor === color && currentTool !== 'eraser'"
             (click)="selectPresetColor(color)">
        </div>
      </div>
      <div class="color-picker-btn" (click)="openColorPicker()">
        <div class="rainbow-circle"></div>
      </div>
    </div>

    <!-- Hidden Color Picker -->
    <input type="color" 
           [(ngModel)]="selectedColor"
           (change)="setColor(selectedColor)"
           class="hidden-color-picker"
           [disabled]="currentTool === 'eraser'">
          </div>

</app-game-template>
<app-game-template 
  [showHeader]="false" 
  [showTopIcons]="false" 
  [noCardBackground]="true">  
      <div class="card" >
      
      <!-- Header -->
      <div class="game py-2 px-3 text-white d-flex justify-content-between align-items-center">
<img src="/images/logo-patarif.png" style="width: 50px; height: 50px;">      
  <div class="d-flex gap-2">
          <button class="btn btn-sm btn-light rounded-circle" (click)="undo()" title="Annuler (Ctrl+Z)" [disabled]="historyIndex <= 0">
            <i class="fas fa-undo"></i>
          </button>
          <button class="btn btn-sm btn-light rounded-circle" (click)="redo()" title="Rétablir (Ctrl+Y)" [disabled]="historyIndex >= drawingHistory.length - 1">
            <i class="fas fa-redo"></i>
          </button>
          <button class="btn btn-sm btn-light rounded-pill d-flex align-items-center gap-1" (click)="clearCanvas()">
            <i class="fas fa-trash-alt"></i> Tout effacer
          </button>
          <button class="btn btn-sm btn-primary rounded-pill d-flex align-items-center gap-1" (click)="downloadImage()">
            <i class="fas fa-download"></i> Télécharger
          </button>
        </div>
      </div>
      
      <!-- Body -->
      <div class="card-body d-flex p-0 w-100 ">
        <!-- Canvas -->
        <div class="flex-grow-1 d-flex align-items-center justify-content-center p-3 w-100  ">
          <canvas #coloringCanvas
                  class="w-100 z-index-1"
                  (mousedown)="startDrawing($event)"
                  (mousemove)="onMouseMove($event)"
                  (mouseup)="stopDrawing()"
                  (mouseleave)="onMouseLeave()"
                  (touchstart)="startDrawing($event)"
                  (touchmove)="onTouchMove($event)"
                  (touchend)="stopDrawing()"
                  (contextmenu)="$event.preventDefault()"></canvas>
          <div #cursorElement class="cursor" [class.pen]="!isEraser" [class.eraser]="isEraser"></div>
        </div>
           <!-- Sidebar Tools -->
           <div class="tools-sidebar">
            <!-- Pen -->
            <button class="tool-btn"
                    [class.active-tool]="!isEraser"
                    (click)="selectTool('pen')" 
                    title="Stylo">
              <img src="/images/brush .png" alt="Brush"/>
            </button>
            
            <!-- Eraser -->
            <button class="tool-btn"
                    [class.active-tool]="isEraser"
                    (click)="selectTool('eraser')" 
                    title="Gomme">
              <img src="/images/eraser.png" alt="Eraser"/>
            </button>
    
            <div class="divider"></div>
    
            <!-- Color Picker -->
            <div class="color-picker-wrapper">
              <input type="color"
                    [(ngModel)]="selectedColor"
                    (change)="onColorChange()"
                    [disabled]="isEraser"
                    title="Choisir une couleur">
            </div>
    
            <!-- Brush Size -->
            <div class="brush-controls">
              <div class="brush-preview-container">
                <div class="brush-preview" 
                     [style.width.px]="brushSize" 
                     [style.height.px]="brushSize"
                     [style.background]="isEraser ? '#000' : selectedColor"
                     [style.border]="'2px solid ' + (isEraser ? '#fff' : '#333')">
                </div>
                <div class="brush-size-value">{{brushSize}}px</div>
              </div>
              <input type="range"
                    min="1" 
                    max="50"
                    class="vertical-slider"
                    [value]="brushSize"
                    (input)="onBrushSizeChange($event)">
            </div>
          </div>
      </div>
          <!-- Preset Colors -->
          <div class="d-flex flex-wrap gap-2 my-3 justify-content-center">
            <div *ngFor="let color of colorPresets"
                 (click)="selectPresetColor(color)"
                 [style.background]="color"
                 class="rounded-circle border"
                 style="width: 24px; height: 24px; cursor: pointer;"
                 [class.border-primary]="selectedColor === color && !isEraser"></div>
          </div>
      <!-- Footer -->
      <!-- <div class="card-footer d-flex justify-content-between bg-light">
        <button class="btn btn-danger d-flex align-items-center gap-2" (click)="clearCanvas()">
          <i class="fas fa-trash-alt"></i> Effacer la toile
        </button>
        <button class="btn btn-outline-secondary d-flex align-items-center gap-2" (click)="goBack()">
          <i class="fas fa-arrow-right"></i> Retour
        </button>
      </div> -->
    </div>
  
</app-game-template>

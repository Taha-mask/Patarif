<app-game-template
  [level]="level"
  [questionsCorrectInLevel]="questionsCorrectInLevel"
  [totalQuestions]="questionsInLevel"
  [timeElapsed]="timeElapsed"
  [currentWord]="currentWord.correct || ''"
  [difficulty]="currentWord.difficulty"
>


  <div class="container d-flex justify-content-center align-items-center py-4">
    <div class="game-card">

      <!-- ===== QUESTION SECTION ===== -->
      <div class="question-section">
        <div class="card-title">
          Arrangez la phrase
        </div>
      </div>

      <div class="card-body">

        <!-- Mots mélangés -->
        <div class="mb-3 d-flex flex-wrap justify-content-center">
          <button 
            *ngFor="let word of shuffledWords; let i = index"
            class="btn me-2 mb-2"
            (click)="selectWord(word)"
            [style.backgroundColor]="getColor(word)"
            [attr.aria-label]="'Sélectionner le mot : ' + word">
            {{ word }}
          </button>
        </div>

        <!-- Mots sélectionnés -->
        <div class="selected-words mb-4">
          <div *ngIf="selectedWords.length === 0" class="text-muted h-100 d-flex align-items-center justify-content-center">
            <div class="text-center">
              <i class="bi bi-arrow-up-circle fs-1 d-block mb-2"></i>
              <span>Cliquez sur les mots ci-dessus pour former votre phrase</span>
            </div>
          </div>
          <div *ngIf="selectedWords.length > 0" class="selected-sentence d-flex flex-wrap">
            <span 
              *ngFor="let word of selectedWords; let i = index" 
              class="btn me-2 mb-2"
              [style.backgroundColor]="getColor(word)"
              [attr.aria-label]="'Mot sélectionné : ' + word"
              (click)="removeWord(word, i)"
            >
              {{ word }}
              <i class="bi bi-x ms-1"></i>
            </span>
          </div>
        </div>

        <!-- Feedback -->
        <div *ngIf="feedback" class="feedback mb-3" 
             [ngClass]="{'correct': isCorrect, 'wrong': !isCorrect}">
          <i class="bi" [ngClass]="isCorrect ? 'bi-check-circle-fill' : 'bi-x-circle-fill'"></i>
          {{ isCorrect ? '✅ Correct!' : '❌ Faux!' }}
        </div>

        <!-- Boutons d'action -->
        <section class="action-section">
          <div class="action-card">
            <button 
              class="game-btn" 
              [disabled]="selectedWords.length === 0"
              (click)="handleButton()"
              [ngClass]="{'ready': selectedWords.length > 0}"
            >
              <span class="button-text">
                {{ !feedback ? 'Vérifier' : (isCorrect ? (currentIndex < sentences.length - 1 ? 'Question suivante' : 'Terminer le niveau') : 'Réessayer') }}
              </span>
              <span class="button-icon">
                <i *ngIf="!feedback" class="fas fa-check"></i>
                <i *ngIf="feedback && isCorrect && currentIndex < sentences.length - 1" class="fas fa-arrow-right"></i>
                <i *ngIf="feedback && isCorrect && currentIndex >= sentences.length - 1" class="fas fa-flag-checkered"></i>
                <i *ngIf="feedback && !isCorrect" class="fas fa-redo"></i>
              </span>
            </button>
          </div>
        </section>
        
        
      </div>
    </div>
  </div>
</app-game-template>

<!-- Celebration Modal -->
<app-celebration
  [show]="showCelebration"
  [data]="celebrationData"
  (close)="onCloseCelebration()"
  (goToNext)="onNextLevel()">
</app-celebration>

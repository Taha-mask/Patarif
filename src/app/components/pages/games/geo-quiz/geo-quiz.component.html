<app-game-template
  [level]="level"
  [currentQuestion]="currentQuestionIndex + 1"
  [questionsCorrectInLevel]="currentQuestionIndex + 1"
  [timeElapsed]="timeElapsed"
  [currentWord]="currentQuestion?.name || ''"
  [difficulty]="currentQuestion?.difficulty || 'facile'"
  [totalQuestions]="points.length"
>  
  <div class="game-layout">
    <div class="question-section">
      <div class="card-title">Le lieu sur la carte ?</div>
    </div>

    <div class="two-column-layout mt-3">
      <div class="left-column">
        <div class="map-card">
          <div #svgHost class="svg-container"></div>
          <div *ngIf="loading" class="loading-container">
            <div class="spinner-border text-primary" role="status"></div>
            <div class="loading-text mt-3">Chargement de la carte...</div>
          </div>
        </div>
      </div>

      <div class="right-column">
        <div class="answer-section mb-3">
          <div class="answer-grid">
            <div *ngFor="let option of options; let i = index" 
                 class="option-btn"
                 [ngClass]="{
                   'selected': selectedAnswer === option && !answered,
                   'btn-success': answered && answerStatus[i] === 'correct',
                   'btn-danger': answered && answerStatus[i] === 'wrong',
                   'correct-answer': answered && answerStatus[i] === 'correct'
                 }"
                 (click)="!answered && selectAnswer(option, i)">
              
              <div class="answer-content">
                <div class="option-badge">{{ getOptionLetter(i) }}</div>
                <div class="option-text">{{ option }}</div>
                <div class="result-icon" *ngIf="answered">
                  <i *ngIf="answerStatus[i] === 'correct'" class="fas fa-check"></i>
                  <i *ngIf="answerStatus[i] === 'wrong'" class="fas fa-times"></i>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="action-section">
          <div class="action-card">
            <button class="game-btn" 
                    [disabled]="!answered" 
                    (click)="nextQuestion()"
                    [ngClass]="{'ready': answered}">
              <span class="button-text">Question suivante</span>
              <div class="button-icon"><i class="fas fa-arrow-right"></i></div>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <app-celebration
    [show]="showCelebration"
    [nextLevel]="level + 1"
    [data]="{
      level: level,
      questionsCorrect: score,
      totalQuestions: points.length,
      timeElapsed: timeElapsed,
      difficulty: currentQuestion?.difficulty || 'facile'
    }"
    (close)="onCloseCelebration()"
    (goToNext)="onNextLevel($event)">
  </app-celebration>

</app-game-template>

<app-game-template
  [level]="currentLevel"
  [questionsCorrectInLevel]="questionsCorrectInLevel"
  [currentQuestion]="currentQuestion"
  [timeElapsed]="timeElapsed"
  [currentWord]="currentQuestionData?.correctAnswer || ''"
  [difficulty]="currentDifficulty"
  [totalQuestions]="5"
>  <div class="container py-4" [@fadeIn]>
    <!-- Game Header with Timer and Stats -->

    <!-- Loading -->
    <div *ngIf="isLoading" class="loading-container">
      <div class="spinner-border text-primary" role="status"></div>
      <div class="loading-text mt-3">Chargement des pays...</div>
    </div>

    <!-- Game Content -->
    <div *ngIf="!isLoading && !showLevelComplete">

 
      <!-- Image + Hint -->
      <div class="image-container mb-4" [@fadeIn]>
        <img [src]="currentQuestionData.image" class="img-fluid rounded" alt="Country Image">
        <div class="image-overlay p-3">
          <p class="hint-text">{{ currentQuestionData.hint }}</p>
        </div>
      </div>

      <!-- Question -->
      <div class="question-text text-center mb-4">
        <h2>Quel est ce pays ?</h2>
      </div>

      <!-- Options -->
      <div class="row">
        <div *ngFor="let option of currentQuestionData.options" class="col-12 col-md-6 mb-3">
          <button
            class="option-btn w-100"
            [ngClass]="{
              'selected': selectedAnswer === option && !showResult,
              'btn-success': showResult && option === currentQuestionData.correctAnswer,
              'btn-danger': showResult && selectedAnswer === option && !isCorrect,
              'correct-answer': showResult && option === currentQuestionData.correctAnswer && !isCorrect && selectedAnswer !== option
            }"
            [disabled]="showResult"
            (click)="selectAnswer(option)">
            {{ option }}
            <span *ngIf="showResult" class="result-icon">
              <span *ngIf="option === currentQuestionData.correctAnswer">âœ“</span>
              <span *ngIf="selectedAnswer === option && !isCorrect">âœ—</span>
            </span>
          </button>
        </div>

        <!-- Correct answer display -->
        <div class="col-12 text-center mt-2" *ngIf="showResult && !isCorrect">
          <div class="alert alert-info">
            La bonne rÃ©ponse est : <strong>{{ currentQuestionData.correctAnswer }}</strong>
          </div>
        </div>

        <!-- Next -->
        <div class="col-12 text-center" *ngIf="showResult">
          <button class="btn btn-primary" (click)="nextQuestion()">
            {{ currentQuestionIndex + 1 < 5 ? 'Question suivante' : 'Terminer le niveau' }}
          </button>
        </div>
      </div>
    </div>

    <!-- Bootstrap Modal -->
    <div class="modal fade" 
         [class.show]="showLevelComplete" 
         [style.display]="showLevelComplete ? 'block' : 'none'"
         tabindex="-1" 
         role="dialog" 
         aria-labelledby="levelCompleteModalLabel" 
         aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content celebration-modal">
          <div class="modal-header border-0">
            <h5 class="modal-title" id="levelCompleteModalLabel">
              ðŸŽ‰ Niveau {{ currentLevel }} terminÃ© ! ðŸŽ‰
            </h5>
            <button type="button" class="btn-close" (click)="nextLevel()" aria-label="Close"></button>
          </div>
          <div class="modal-body text-center">
            <h4 class="mb-3">FÃ©licitations !</h4>
            <div class="alert alert-success">
              <i class="fas fa-star text-warning"></i>
              Vous avez rÃ©pondu correctement Ã  {{ questionsCorrectInLevel }} questions sur {{ questionsPerLevel }} !
            </div>
            <div class="level-progress mb-3">
              <div class="progress">
                <div class="progress-bar bg-success" role="progressbar" [style.width.%]="getLevelScorePercentage()"></div>
              </div>
              <small class="text-muted">{{ getLevelScorePercentage() }}% de rÃ©ussite</small>
            </div>
            <div class="score-display mb-3">
              <h3 class="text-primary">{{ score }}</h3>
              <p class="mb-0">Points obtenus</p>
            </div>
            <div class="score-message">
              <p class="mb-0">{{ getScoreMessage() }}</p>
            </div>
          </div>
          <div class="modal-footer border-0 justify-content-center">
            <button type="button" class="btn btn-primary btn-lg px-4" (click)="nextLevel()">
              <i class="fas fa-arrow-right me-2"></i>
              Continuer au niveau {{ currentLevel + 1 }}
            </button>
          </div>
        </div>
      </div>
    </div>

  </div>
</app-game-template>

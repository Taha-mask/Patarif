<app-game-template
  [level]="level"
  [currentQuestion]="currentIndex + 1"
  [questionsCorrectInLevel]="questionsCorrectInLevel"
  [timeElapsed]="timeElapsed"
  [currentWord]="currentQuestion?.value || ''"
  [difficulty]="currentQuestion?.difficulty || 'facile'"
  [totalQuestions]="QUESTIONS_PER_LEVEL"
>  
  <div class="game-layout" *ngIf="!loading; else loadingTemplate">
    
   

    <!-- ===== QUESTION SECTION ===== -->
    <div class="question-section">
      <div class="card-title">Devinez la signification !</div>
    </div>
    <div class="emoji-display m-auto">{{ currentQuestion.emojis }}</div>

    <!-- ===== ANSWER SECTION ===== -->
    <div class="answer-grid">
      <div *ngFor="let option of currentQuestion.options; let i = index" 
           class="option-btn"
           [ngClass]="{
             'selected': selectedOption === option && !feedback,
             'btn-success': feedback && option === currentQuestion.value,
             'btn-danger': feedback && selectedOption === option && option !== currentQuestion.value,
             'correct-answer': feedback && option === currentQuestion.value
           }"
           (click)="!feedback && checkAnswer(option)">
        <div class="answer-content">
          <div class="option-badge">{{ getOptionLetter(i) }}</div>
          <div class="option-text">{{ option }}</div>
          <div class="result-icon" *ngIf="feedback">
            <i *ngIf="option === currentQuestion.value" class="fas fa-check"></i>
            <i *ngIf="selectedOption === option && option !== currentQuestion.value" class="fas fa-times"></i>
          </div>
        </div>
      </div>
    </div>

    <!-- ===== ACTION SECTION ===== -->
    <section class="action-section">
      <div class="action-card">
        <button 
          class="game-btn" 
          [disabled]="!selectedOption" 
          (click)="nextQuestion()"
          [ngClass]="{'ready': selectedOption}"
        >
          <span class="button-text">
            {{ currentIndex < questions.length - 1 ? 'Question suivante' : 'Terminer le niveau' }}
          </span>
          <span class="button-icon">
            <i *ngIf="currentIndex < questions.length - 1" class="fas fa-arrow-right"></i>
            <i *ngIf="currentIndex >= questions.length - 1" class="fas fa-flag-checkered"></i>
          </span>
        </button>
      </div>
    </section>

  </div>

  <ng-template #loadingTemplate>
    <div class="loading-screen m-auto">
      <div class="spinner"></div>
      <p>Chargement des questions...</p>
    </div>
  </ng-template>
      <!-- ===== CELEBRATION MODAL ===== -->
      <app-celebration 
      *ngIf="showCelebration"
      [show]="showCelebration"
      [nextLevel]="level + 1"
      [data]="celebrationData"
      (close)="onCelebrationClose()"
      (goToNext)="onNextLevel($event)">
    </app-celebration>

</app-game-template>
